generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model accounts {
  id                  String  @id
  user_id             String
  type                String
  provider            String
  provider_account_id String
  refresh_token       String?
  access_token        String?
  expires_at          Int?
  token_type          String?
  scope               String?
  id_token            String?
  session_state       String?
  users               users   @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([provider, provider_account_id])
}

model date_courses {
  id            String      @id
  restaurant_id String
  user_id       String?
  course_name   String
  description   String?
  is_public     Boolean     @default(true)
  created_at    DateTime    @default(now())
  updated_at    DateTime
  restaurants   restaurants @relation(fields: [restaurant_id], references: [id], onDelete: Cascade)
  users         users?      @relation(fields: [user_id], references: [id])
}

model favorites {
  id            String      @id
  user_id       String
  restaurant_id String
  created_at    DateTime    @default(now())
  restaurants   restaurants @relation(fields: [restaurant_id], references: [id], onDelete: Cascade)
  users         users       @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([user_id, restaurant_id])
}

model purpose_categories {
  id                  String                @id
  name                String                @unique
  description         String?
  is_active           Boolean               @default(true)
  created_at          DateTime              @default(now())
  updated_at          DateTime
  restaurant_purposes restaurant_purposes[]
}

model restaurant_purposes {
  id                  String             @id
  restaurant_id       String
  purpose_category_id String
  priority            Int                @default(0)
  created_at          DateTime           @default(now())
  purpose_categories  purpose_categories @relation(fields: [purpose_category_id], references: [id], onDelete: Cascade)
  restaurants         restaurants        @relation(fields: [restaurant_id], references: [id], onDelete: Cascade)

  @@unique([restaurant_id, purpose_category_id])
}

model restaurants {
  id                   String                @id
  name                 String
  name_kana            String?
  area                 String
  address              String
  address_detail       String?
  phone_number         String?
  price_range          PriceRange
  atmosphere           String?
  customer_segment     String?
  side_by_side_seats   Boolean               @default(false)
  hotel_distance_walk  Int?
  hotel_distance_train Int?
  latitude             Float
  longitude            Float
  description          String?
  image_url            String?
  website_url          String?
  reservation_url      String?
  is_active            Boolean               @default(true)
  created_at           DateTime              @default(now())
  updated_at           DateTime
  date_courses         date_courses[]
  favorites            favorites[]
  restaurant_purposes  restaurant_purposes[]
  reviews              reviews[]
}

model reviews {
  id                   String      @id
  restaurant_id        String
  user_id              String?
  rating               Int
  date_appropriateness Int
  review_text          String
  is_premium_only      Boolean     @default(false)
  is_anonymous         Boolean     @default(true)
  created_at           DateTime    @default(now())
  updated_at           DateTime
  restaurants          restaurants @relation(fields: [restaurant_id], references: [id], onDelete: Cascade)
  users                users?      @relation(fields: [user_id], references: [id])
}

model sessions {
  id            String   @id
  session_token String   @unique
  user_id       String
  expires       DateTime
  users         users    @relation(fields: [user_id], references: [id], onDelete: Cascade)
}

model users {
  id                      String         @id
  name                    String?
  email                   String         @unique
  email_verified          DateTime?
  image                   String?
  password                String?
  plan_type               PlanType       @default(FREE)
  subscription_start_date DateTime?
  subscription_end_date   DateTime?
  stripe_customer_id      String?        @unique
  stripe_subscription_id  String?        @unique
  created_at              DateTime       @default(now())
  updated_at              DateTime
  accounts                accounts[]
  date_courses            date_courses[]
  favorites               favorites[]
  reviews                 reviews[]
  sessions                sessions[]
}

model verification_tokens {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

enum PlanType {
  FREE
  PREMIUM_MONTHLY
  PREMIUM_YEARLY
}

enum PriceRange {
  UNDER_3000
  BETWEEN_3000_5000
  BETWEEN_5000_10000
  OVER_10000
}
