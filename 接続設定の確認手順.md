# Supabase接続設定の確認手順

## 確認すべき項目

### 1. Connection stringの取得方法

1. Supabaseダッシュボード → `premier-date` プロジェクトを選択
2. 左メニュー → **「Settings」** → **「Database」**
3. **「Connection string」** セクションを開く
4. 以下の項目を確認：

   **a) 接続方式の選択**
   - 「Direct connection」（直接接続）
   - 「Connection pooling」（接続プーリング）
   
   **重要**: Prisma Migrateには **「Direct connection」** が必要です。

   **b) 接続URLの形式**
   - 「URI」タブを選択
   - 表示される接続URLを確認

### 2. IP Allowlistの確認

1. Settings → Database
2. **「Connection pooling」** セクションまたは **「Network restrictions」** セクションを確認
3. **「IP Allowlist」** の設定を確認：
   - すべてのIPアドレスからの接続が許可されているか？
   - 特定のIPアドレスが許可されている場合、現在のIPアドレスが含まれているか？

### 3. 接続URLの完全コピー

Supabaseダッシュボードで表示される接続URLを、**そのまま完全にコピー**してください。

**注意**: 
- `[YOUR-PASSWORD]` というプレースホルダーが含まれている場合は、実際のパスワード `dateguide202512` に置き換える必要があります
- しかし、Supabaseの新しいバージョンでは、パスワードが自動的にマスクされているだけで、実際のURLには含まれている場合があります

---

## 現在の状況

- ✅ データベースは正常に動作している（SQL EditorでSQLが実行できる）
- ✅ 環境変数は正しく読み込まれている
- ❌ Prisma CLIからの接続ができない

この状況は、**接続方式やネットワーク設定の問題**である可能性が高いです。

---

## 次のステップ

1. **Settings → Database で接続設定を確認**
   - 「Direct connection」が選択されているか確認
   - 「IP Allowlist」の設定を確認

2. **接続URLを完全にコピー**
   - 表示されている接続URL全体をコピー
   - `[YOUR-PASSWORD]` が含まれている場合は、`dateguide202512` に置き換える

3. **接続URLと設定を共有**
   - 接続URL全体
   - 「Direct connection」が選択されているか
   - 「IP Allowlist」の設定内容

---

**Settings → Database の画面を確認して、上記の情報を教えてください！**



