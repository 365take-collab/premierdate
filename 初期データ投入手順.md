# 初期データ投入手順

## Prisma Studioでのデータ投入

Prisma Studioを起動しました。ブラウザで `http://localhost:5555` にアクセスしてください。

## 手順

### 1. 用途カテゴリの追加

1. 左サイドバーで「purpose_categories」を選択
2. 「Add record」ボタンをクリック
3. 以下のデータを追加：

| name | description | is_active |
|------|-------------|-----------|
| 初デート | 初めてのデートにおすすめのお店 | true |
| 誕生日 | 誕生日のデートにおすすめのお店 | true |
| 記念日 | 記念日のデートにおすすめのお店 | true |
| カジュアルデート | 気軽に楽しめるデートにおすすめのお店 | true |
| 夜のデート | 夜のデートにおすすめのお店 | true |

**注意**: `id`, `created_at`, `updated_at`は自動生成されます。

### 2. サンプル店舗データの追加

1. 左サイドバーで「restaurants」を選択
2. 「Add record」ボタンをクリック
3. 以下のサンプルデータを追加：

#### サンプル店舗1: レストラン サンプル1

- name: `レストラン サンプル1`
- area: `渋谷`
- address: `東京都渋谷区道玄坂1-2-3`
- price_range: `BETWEEN_3000_5000`
- atmosphere: `落ち着いた雰囲気`
- customer_segment: `20代-30代`
- side_by_side_seats: `true`
- hotel_distance_walk: `10`
- hotel_distance_train: `5`
- latitude: `35.658034`
- longitude: `139.701636`
- description: `デートに最適な落ち着いたレストランです。`
- is_active: `true`

#### サンプル店舗2: レストラン サンプル2

- name: `レストラン サンプル2`
- area: `新宿`
- address: `東京都新宿区新宿3-1-1`
- price_range: `BETWEEN_5000_10000`
- atmosphere: `高級感のある雰囲気`
- customer_segment: `30代-40代`
- side_by_side_seats: `true`
- hotel_distance_walk: `15`
- hotel_distance_train: `8`
- latitude: `35.690921`
- longitude: `139.700258`
- description: `記念日に最適な高級レストランです。`
- is_active: `true`

#### サンプル店舗3: レストラン サンプル3

- name: `レストラン サンプル3`
- area: `表参道`
- address: `東京都渋谷区神宮前4-1-1`
- price_range: `OVER_10000`
- atmosphere: `洗練された雰囲気`
- customer_segment: `20代-30代`
- side_by_side_seats: `false`
- hotel_distance_walk: `20`
- hotel_distance_train: `10`
- latitude: `35.665412`
- longitude: `139.712677`
- description: `おしゃれなデートに最適なレストランです。`
- is_active: `true`

### 3. 店舗と用途の関連付け

1. 左サイドバーで「restaurant_purposes」を選択
2. 「Add record」ボタンをクリック
3. 各店舗と用途カテゴリの関連を追加：

| restaurant_id | purpose_category_id | priority |
|---------------|---------------------|----------|
| （レストラン サンプル1のID） | （初デートのID） | 0 |
| （レストラン サンプル1のID） | （カジュアルデートのID） | 0 |
| （レストラン サンプル2のID） | （誕生日のID） | 0 |
| （レストラン サンプル2のID） | （記念日のID） | 0 |
| （レストラン サンプル3のID） | （記念日のID） | 0 |
| （レストラン サンプル3のID） | （夜のデートのID） | 0 |

**注意**: `restaurant_id`と`purpose_category_id`は、各テーブルで確認したIDをコピー＆ペーストしてください。

## 代替方法: SQL Editorで直接実行

Prisma Studioが使いにくい場合は、SupabaseのSQL Editorで以下のSQLを実行してください：

```sql
-- 用途カテゴリの作成
INSERT INTO purpose_categories (id, name, description, is_active, created_at, updated_at)
VALUES
  (gen_random_uuid(), '初デート', '初めてのデートにおすすめのお店', true, NOW(), NOW()),
  (gen_random_uuid(), '誕生日', '誕生日のデートにおすすめのお店', true, NOW(), NOW()),
  (gen_random_uuid(), '記念日', '記念日のデートにおすすめのお店', true, NOW(), NOW()),
  (gen_random_uuid(), 'カジュアルデート', '気軽に楽しめるデートにおすすめのお店', true, NOW(), NOW()),
  (gen_random_uuid(), '夜のデート', '夜のデートにおすすめのお店', true, NOW(), NOW())
ON CONFLICT (name) DO NOTHING;

-- サンプル店舗データの作成
WITH restaurant1 AS (
  INSERT INTO restaurants (
    id, name, area, address, price_range, atmosphere, customer_segment,
    side_by_side_seats, hotel_distance_walk, hotel_distance_train,
    latitude, longitude, description, is_active, created_at, updated_at
  )
  VALUES (
    gen_random_uuid(), 'レストラン サンプル1', '渋谷', '東京都渋谷区道玄坂1-2-3',
    'BETWEEN_3000_5000', '落ち着いた雰囲気', '20代-30代',
    true, 10, 5,
    35.658034, 139.701636, 'デートに最適な落ち着いたレストランです。', true, NOW(), NOW()
  )
  RETURNING id, (SELECT id FROM purpose_categories WHERE name = '初デート') as purpose1_id,
             (SELECT id FROM purpose_categories WHERE name = 'カジュアルデート') as purpose2_id
)
INSERT INTO restaurant_purposes (id, restaurant_id, purpose_category_id, priority, created_at)
SELECT gen_random_uuid(), id, purpose1_id, 0, NOW() FROM restaurant1
UNION ALL
SELECT gen_random_uuid(), id, purpose2_id, 0, NOW() FROM restaurant1;
```

（残りの店舗データも同様に追加）

## データ投入後の確認

データ投入後、以下のURLで確認してください：

- 検索ページ: `http://localhost:3000/search`
- 店舗一覧API: `http://localhost:3000/api/restaurants`

